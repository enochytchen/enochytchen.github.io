<?xml version="1.0" encoding="utf-8" standalone="yes" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>expected survival | Enoch Yi-Tung Chen</title>
    <link>https://enochytchen.com/tag/expected-survival/</link>
      <atom:link href="https://enochytchen.com/tag/expected-survival/index.xml" rel="self" type="application/rss+xml" />
    <description>expected survival</description>
    <generator>Source Themes Academic (https://sourcethemes.com/academic/)</generator><language>en-us</language><lastBuildDate>Wed, 19 Aug 2020 00:00:00 +0000</lastBuildDate>
    <image>
      <url>https://enochytchen.com/images/icon_hu0b7a4cb9992c9ac0e91bd28ffd38dd00_9727_512x512_fill_lanczos_center_2.png</url>
      <title>expected survival</title>
      <link>https://enochytchen.com/tag/expected-survival/</link>
    </image>
    
    <item>
      <title>Estimating relative survival: using rs.surv() vs. strs</title>
      <link>https://enochytchen.com/post/estimatingrs/</link>
      <pubDate>Wed, 19 Aug 2020 00:00:00 +0000</pubDate>
      <guid>https://enochytchen.com/post/estimatingrs/</guid>
      <description> &lt;h2&gt;Table of Contents&lt;/h2&gt;
&lt;nav id=&#34;TableOfContents&#34;&gt;
  &lt;ul&gt;
    &lt;li&gt;
      &lt;ul&gt;
        &lt;li&gt;&lt;a href=&#34;#introduction&#34;&gt;Introduction&lt;/a&gt;&lt;/li&gt;
        &lt;li&gt;&lt;a href=&#34;#ederer-ii-esitmator&#34;&gt;Ederer II esitmator&lt;/a&gt;&lt;/li&gt;
        &lt;li&gt;&lt;a href=&#34;#pohar-perme-estimator&#34;&gt;Pohar-Perme estimator&lt;/a&gt;&lt;/li&gt;
        &lt;li&gt;&lt;a href=&#34;#reference&#34;&gt;Reference&lt;/a&gt;&lt;/li&gt;
      &lt;/ul&gt;
    &lt;/li&gt;
  &lt;/ul&gt;
&lt;/nav&gt;
&lt;h3 id=&#34;introduction&#34;&gt;Introduction&lt;/h3&gt;
&lt;p&gt;The codes of this blog post can be found at 
&lt;a href=&#34;https://enochytchen.com/post/estimatingrs/rssurv.R&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;rssurv.R&lt;/a&gt; and 
&lt;a href=&#34;https://enochytchen.com/post/estimatingrs/strs.do&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;strs.do&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;The beauty of using relative survival to estimate net survival is that cause of death information is not required, whereas cause of death needs to be classified completely within cause-specific framework (1). Both &lt;code&gt;relsurv::rs.surv()&lt;/code&gt; command in R and &lt;code&gt;strs&lt;/code&gt; command in Stata supports estimating net survival in relative survival framework. However, people might be curious about the difference in between. Here is an example below of using the same dataset, identical definition of status (alive, dead from cancer, or dead from other causes), and same approaches (Ederer II and Pohar Perme estimator) to estimate relative survival using &lt;code&gt;rs.surv()&lt;/code&gt; and &lt;code&gt;strs&lt;/code&gt;.&lt;/p&gt;
&lt;h3 id=&#34;ederer-ii-esitmator&#34;&gt;Ederer II esitmator&lt;/h3&gt;
&lt;h4 id=&#34;rssurv-in-r&#34;&gt;&lt;code&gt;rs.surv()&lt;/code&gt; in R&lt;/h4&gt;
&lt;pre&gt;&lt;code&gt;rssurv_e2 &amp;lt;- rs.surv(Surv(time  =  (decimal_date(exit)-  decimal_date(dx)) * 365.241, # time in days
                          event = status== 1 | status== 2 ) ~ sex,
                     rmap = list(age = age * 365.241, year = dx),
                     data = colon1,
                     ratetable = popmort_new,
                     method = &amp;quot;ederer2&amp;quot;)

rs.table_e2 &amp;lt;- as.data.frame(summary(rssurv_e2, time = c(0:10) * 365.241, scale = 365.241)
                             [c(&amp;quot;strata&amp;quot;, &amp;quot;time&amp;quot;, &amp;quot;n.risk&amp;quot;, &amp;quot;n.event&amp;quot;, &amp;quot;surv&amp;quot;, &amp;quot;std.err&amp;quot;, &amp;quot;lower&amp;quot;, &amp;quot;upper&amp;quot;)])

#&#39; Rename the columns
strs_e2 &amp;lt;- rs.table_e2 %&amp;gt;%
  mutate(cr_e2 = surv, 
         lo_cr_e2 = round(lower, digits = 4),
         hi_cr_e2 = round(upper, digits = 4),
         sex = ifelse(strata == &amp;quot;sexFemale=0&amp;quot;, &amp;quot;Male&amp;quot;, &amp;quot;Female&amp;quot;),
         
  )%&amp;gt;%
  select(sex, time, n.risk, n.event, r, cr_e2, lo_cr_e2, hi_cr_e2)
&lt;/code&gt;&lt;/pre&gt;






  
  











&lt;figure id=&#34;figure-estimating-net-survival-using-rssurv-ederer-ii&#34;&gt;


  &lt;a data-fancybox=&#34;&#34; href=&#34;https://enochytchen.com/post/estimatingrs/rssurv_e2_hu8abfbb7ac3a206dbc575ca0455fad598_77860_2000x2000_fit_lanczos_2.png&#34; data-caption=&#34;Estimating net survival using rs.surv(), Ederer II&#34;&gt;


  &lt;img data-src=&#34;https://enochytchen.com/post/estimatingrs/rssurv_e2_hu8abfbb7ac3a206dbc575ca0455fad598_77860_2000x2000_fit_lanczos_2.png&#34; class=&#34;lazyload&#34; alt=&#34;&#34; width=&#34;532&#34; height=&#34;533&#34;&gt;
&lt;/a&gt;


  
  
  &lt;figcaption&gt;
    Estimating net survival using rs.surv(), Ederer II
  &lt;/figcaption&gt;


&lt;/figure&gt;

&lt;h4 id=&#34;strs-in-stata&#34;&gt;&lt;code&gt;strs&lt;/code&gt; in Stata&lt;/h4&gt;
&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;use http://enochytchen.com/directory/data/colon.dta if stage==1, clear
stset exit,fail(status==1 2) origin (dx) exit(exit) id(id) scale(365.241) 
strs using popmort, br(0(1)10) mergeby(_year sex _age) by(sex)
&lt;/code&gt;&lt;/pre&gt;






  
  











&lt;figure id=&#34;figure-estimating-net-survival-using-strs-ederer-ii&#34;&gt;


  &lt;a data-fancybox=&#34;&#34; href=&#34;https://enochytchen.com/post/estimatingrs/strs_e2_hu749bcb2913d93d919789b0b56e4bc420_115885_2000x2000_fit_lanczos_2.png&#34; data-caption=&#34;Estimating net survival using strs, Ederer II&#34;&gt;


  &lt;img data-src=&#34;https://enochytchen.com/post/estimatingrs/strs_e2_hu749bcb2913d93d919789b0b56e4bc420_115885_2000x2000_fit_lanczos_2.png&#34; class=&#34;lazyload&#34; alt=&#34;&#34; width=&#34;1028&#34; height=&#34;761&#34;&gt;
&lt;/a&gt;


  
  
  &lt;figcaption&gt;
    Estimating net survival using strs, Ederer II
  &lt;/figcaption&gt;


&lt;/figure&gt;

&lt;h3 id=&#34;pohar-perme-estimator&#34;&gt;Pohar-Perme estimator&lt;/h3&gt;
&lt;h4 id=&#34;rssurv-in-r-1&#34;&gt;&lt;code&gt;rs.surv()&lt;/code&gt; in R&lt;/h4&gt;
&lt;pre&gt;&lt;code&gt;rssurv_pohar &amp;lt;- rs.surv(Surv(time  =  (decimal_date(exit) - decimal_date(dx)) * 365.241, # time in days
                             event = status== 1 | status== 2 ) ~ sex,
                        rmap = list(age = age * 365.241, year = dx),
                        data = colon1,
                        ratetable = popmort_new,
                        method = &amp;quot;pohar-perme&amp;quot;)

rs.table_pohar &amp;lt;- as.data.frame(summary(rssurv_pohar, time = c(0:10) * 365.241, scale = 365.241)
                                [c(&amp;quot;strata&amp;quot;, &amp;quot;time&amp;quot;, &amp;quot;n.risk&amp;quot;, &amp;quot;n.event&amp;quot;, &amp;quot;surv&amp;quot;, &amp;quot;std.err&amp;quot;, &amp;quot;lower&amp;quot;, &amp;quot;upper&amp;quot;)])

#&#39; Rename the columns
strs_pohar &amp;lt;- rs.table_pohar %&amp;gt;%
  mutate(cr_pp = surv, 
         lo_pp = round(lower, digits = 4),
         hi_pp = round(upper, digits = 4),
         sex = ifelse(strata == &amp;quot;sexFemale=0&amp;quot;, &amp;quot;Male&amp;quot;, &amp;quot;Female&amp;quot;),
         r   =   round( cr_pp/lag(cr_pp), digits = 4),
  )%&amp;gt;%
  select(sex, time, n.risk, n.event, cr_pp, lo_pp, hi_pp)
&lt;/code&gt;&lt;/pre&gt;






  
  











&lt;figure id=&#34;figure-estimating-net-survival-using-rssurv-pohar-perme&#34;&gt;


  &lt;a data-fancybox=&#34;&#34; href=&#34;https://enochytchen.com/post/estimatingrs/rssurv_pp_hu0d92bc10ef8284b5b0c994a22a5a6aa6_75914_2000x2000_fit_lanczos_2.png&#34; data-caption=&#34;Estimating net survival using rs.surv(), Pohar-Perme&#34;&gt;


  &lt;img data-src=&#34;https://enochytchen.com/post/estimatingrs/rssurv_pp_hu0d92bc10ef8284b5b0c994a22a5a6aa6_75914_2000x2000_fit_lanczos_2.png&#34; class=&#34;lazyload&#34; alt=&#34;&#34; width=&#34;494&#34; height=&#34;534&#34;&gt;
&lt;/a&gt;


  
  
  &lt;figcaption&gt;
    Estimating net survival using rs.surv(), Pohar-Perme
  &lt;/figcaption&gt;


&lt;/figure&gt;

&lt;h4 id=&#34;strs-in-stata-1&#34;&gt;&lt;code&gt;strs&lt;/code&gt; in Stata&lt;/h4&gt;
&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;use http://enochytchen.com/directory/data/colon.dta if stage==1, clear
stset exit,fail(status==1 2) origin (dx) exit(exit) id(id) scale(365.241) 
strs using popmort, br(0(1)10) mergeby(_year sex _age) by(sex) pohar
&lt;/code&gt;&lt;/pre&gt;






  
  











&lt;figure id=&#34;figure-estimating-net-survival-using-strs-pohar-perme&#34;&gt;


  &lt;a data-fancybox=&#34;&#34; href=&#34;https://enochytchen.com/post/estimatingrs/strs_pp_hu37c54d9fc66187598c1072038a6e423a_110462_2000x2000_fit_lanczos_2.png&#34; data-caption=&#34;Estimating net survival using strs, Pohar-Perme&#34;&gt;


  &lt;img data-src=&#34;https://enochytchen.com/post/estimatingrs/strs_pp_hu37c54d9fc66187598c1072038a6e423a_110462_2000x2000_fit_lanczos_2.png&#34; class=&#34;lazyload&#34; alt=&#34;&#34; width=&#34;951&#34; height=&#34;762&#34;&gt;
&lt;/a&gt;


  
  
  &lt;figcaption&gt;
    Estimating net survival using strs, Pohar-Perme
  &lt;/figcaption&gt;


&lt;/figure&gt;

&lt;h3 id=&#34;reference&#34;&gt;Reference&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;Dickman2006&lt;/li&gt;
&lt;/ol&gt;
</description>
    </item>
    
    <item>
      <title>Not easy to be a fortune teller: prediction is hard</title>
      <link>https://enochytchen.com/post/prediction/</link>
      <pubDate>Tue, 12 May 2020 14:52:16 +0200</pubDate>
      <guid>https://enochytchen.com/post/prediction/</guid>
      <description>&lt;p&gt;There are a bunch of quotes related to prediction which can be found at

&lt;a href=&#34;https://quoteinvestigator.com/2013/10/20/no-predict/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;It’s Difficult to Make Predictions, Especially About the Future&lt;/a&gt;. Basically, these quotes do not differ from one another. They generally want to express that predection on future is risky and chanllenging. Moreover, it could lead to quantitative problems, such as underestimation or overestimation.&lt;/p&gt;
&lt;p&gt;Recently, while I was working on life expectancy estimation, a colleague proposed a quesiton, &amp;ldquo;If you are validating expected survival of patients in 1990s, shall you use the survival projection made in 1990s rather than the empircal survival?&amp;rdquo; As a person living in 2020, it was quite intuitive to me to use empirical data to validate the survival prediction. Nevertheless, practically, statisticians back to 1990s only had projection data. Based on this fact, I was quite convinced that I should have used the projection data made at that time.&lt;/p&gt;
&lt;p&gt;However, how precise was the data? Here come two small examples of validating life expectancy projection in the UK and Sweden.&lt;/p&gt;
&lt;h3 id=&#34;the-uks-life-expectancy-projection&#34;&gt;The UK&amp;rsquo;s life expectancy projection&lt;/h3&gt;
&lt;p&gt;The UK&amp;rsquo;s Office for National Statistics has ever published a report of validating the accurancy of life expectancy. The following figure was downloaded from 
&lt;a href=&#34;https://www.ons.gov.uk/peoplepopulationandcommunity/populationandmigration/populationprojections/methodologies/nationalpopulationprojectionsaccuracyreport&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;National Population Projections Accuracy Report&lt;/a&gt; (1).&lt;/p&gt;
















&lt;figure id=&#34;figure-actual-and-projected-life-expectancy-at-birth-uk-1966-2030&#34;&gt;


  &lt;a data-fancybox=&#34;&#34; href=&#34;./uk_LEprojection.png&#34; data-caption=&#34;Actual and projected life expectancy at birth, UK, 1966-2030&#34;&gt;


  &lt;img src=&#34;./uk_LEprojection.png&#34; alt=&#34;&#34;  &gt;
&lt;/a&gt;


  
  
  &lt;figcaption&gt;
    Actual and projected life expectancy at birth, UK, 1966-2030
  &lt;/figcaption&gt;


&lt;/figure&gt;

&lt;p&gt;It seems that the projection made before 2002 did not perform quite well. For example, projection made in 1975 saying males&amp;rsquo; life expectancy at birth was estimated to be 71 in 2001, whereas in 2001 it was actuall 79. A 8 years of difference! Then let&amp;rsquo;s take a look on the Swedish population.&lt;/p&gt;
&lt;h3 id=&#34;the-swedens-life-expectancy-projection&#34;&gt;The Sweden&amp;rsquo;s life expectancy projection&lt;/h3&gt;
&lt;p&gt;Statistiska centralbyrån (Statistics Sweden) also published a similar report as the UK did to evaluate their previous projection on life expectancy. The following figure was downloaded from 
&lt;a href=&#34;http://share.scb.se/ov9993/data/publikationer/statistik/_publikationer/be0401_2012i60_br_be51br1202.pdf&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Sveriges framtida befolkning 2012–2060&lt;/a&gt;(2).&lt;/p&gt;
















&lt;figure id=&#34;figure-actual-and-projected-life-expectancy-at-birth-sweden-1950-2012&#34;&gt;


  &lt;a data-fancybox=&#34;&#34; href=&#34;./se_LEprojection.png&#34; data-caption=&#34;Actual and projected life expectancy at birth, Sweden, 1950-2012&#34;&gt;


  &lt;img src=&#34;./se_LEprojection.png&#34; alt=&#34;&#34;  &gt;
&lt;/a&gt;


  
  
  &lt;figcaption&gt;
    Actual and projected life expectancy at birth, Sweden, 1950-2012
  &lt;/figcaption&gt;


&lt;/figure&gt;

&lt;p&gt;The similar issue happened here as well. Earlier projection (before 2000) was not quite right in comparison with the empirical one.&lt;/p&gt;
&lt;p&gt;This report was done in 2012 (the empirical trend until 2012). I then followed what Statistics Sweden conducted to generate a similar graph with the earliest open-access projection data till 2009 and empirical data till 2018 using data from Statistics Sweden (3) as well.&lt;/p&gt;
















&lt;figure id=&#34;figure-actual-and-projected-life-expectancy-at-birth-sweden-2000-2030&#34;&gt;


  &lt;a data-fancybox=&#34;&#34; href=&#34;./LEprojection_validation_SE_2030.jpg&#34; data-caption=&#34;Actual and projected life expectancy at birth, Sweden, 2000-2030.&#34;&gt;


  &lt;img src=&#34;./LEprojection_validation_SE_2030.jpg&#34; alt=&#34;&#34;  &gt;
&lt;/a&gt;


  
  
  &lt;figcaption&gt;
    Actual and projected life expectancy at birth, Sweden, 2000-2030.
  &lt;/figcaption&gt;


&lt;/figure&gt;

&lt;p&gt;The difference was not as large as projection before 2000, but still, there could be 1-2 years of difference if projecting to 2030.&lt;/p&gt;
&lt;h3 id=&#34;reflection&#34;&gt;Reflection&lt;/h3&gt;
&lt;p&gt;The validation between the empirical and the projection makes me aware that the longer we predict, the more potential bias may happen as well. This is just an example of why projection into the future could be adventurous. Imagine that if it is already uncertain in life expectancy prediction of the general population, would it be more difficult to predict a group of people&amp;rsquo;s (such as a patient cohort&amp;rsquo;s) survival? For sure, I would pretty much say yes because multiple factors can all contribute to the change of that specific group of people, like advancement of treatment, geographical difference, healthcare delievery, etc.&lt;/p&gt;
&lt;p&gt;Then shall we give up projection? I would however say no. I believe making prediction on something is better than knowing nothing and going ahead, even though people can always argue that we are forecasting &lt;strong&gt;the future&lt;/strong&gt; and say, &amp;ldquo;You never know.&amp;rdquo; Well, at least having a reference point is better than none, isn&amp;rsquo;t it? Still, I agree that there is no perfect prediction. Who knows what is happening tomorrow? However, prediction made diligently is more believable than casually forecasting the future.&lt;/p&gt;
&lt;p&gt;Doesn&amp;rsquo;t my job sound like a fortune teller?&lt;/p&gt;
&lt;h3 id=&#34;reference&#34;&gt;Reference&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;Office for National Statistics, UK. National Population Projections Accuracy Report, 2015. Available from:
&lt;a href=&#34;https://www.ons.gov.uk/peoplepopulationandcommunity/populationandmigration/populationprojections/methodologies/nationalpopulationprojectionsaccuracyreport&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;https://www.ons.gov.uk/&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;Statistiska centralbyrån (Statistics Sweden). Sveriges framtida befolkning 2012–2060 (Sweden&amp;rsquo;s future population), 2012. Available from 
&lt;a href=&#34;http://share.scb.se/ov9993/data/publikationer/statistik/_publikationer/be0401_2012i60_br_be51br1202.pdf&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;http://share.scb.se/&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;Statistiska centralbyrån (Statistics Sweden). Statistical database: Earlier projections on life expectancy by sex and age. Available from: &lt;a href=&#34;http://www.statistikdatabasen.scb.se/pxweb/en/ssd/&#34;&gt;http://www.statistikdatabasen.scb.se/pxweb/en/ssd/&lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;
</description>
    </item>
    
  </channel>
</rss>
